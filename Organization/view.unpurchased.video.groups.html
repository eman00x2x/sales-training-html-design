<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Organizations</title>
    <link
      href="../Cdn/vendor/bootstrap-5.3.3/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../Cdn/css/organization.list.css" />
    <script src="../Cdn/vendor/jquery-3.7.1/jquery-3.7.1.min.js"></script>
    <script src="../Cdn/vendor/popper-2.11.8/popper.min.js"></script>
    <script src="../Cdn/vendor/bootstrap-5.3.3/js/bootstrap.min.js"></script>
    <script src="../Cdn/js/script.js"></script>

    <script type="text/javascript">
      $(document).ready(function () {
        $(".header").load("../Admin/header.html");
        $(".sidebar").load("../Admin/sidebar.html");
        $(".footer").load("../Admin/footer.html");
        getOrganizationsData();
      });

      $(document).on("click", ".btn-add", function () {
        $(".form").load("organization.create.html");
      });

      $(document).on("click", ".btn-edit", function () {
        const id = $(this).data("org-id");
        const url = "organization.list.html?id=" + id;
        window.history.pushState({}, "", url);
        $(".form").load("organization.update.html");
      });

      $(document).on("click", ".btn-delete", function () {
        $(".form").load("organization.delete.html");
      });

      function displayActionButtons(id) {
        return `<td class='align-middle'>
          <button class='btn btn-sm btn-view border border-primary btn-view text-primary' data-title="View Organization">
            <svg xmlns='http://www.w3.org/2000/svg' width='2em' height='2em' viewBox='0 0 32 32'> 
              <circle cx='16' cy='16' r='4' fill='currentColor'/>
              <path fill='currentColor' d='M30.94 15.66A16.69 16.69 0 0 0 16 5A16.69 16.69 0 0 0 1.06 15.66a1 1 0 0 0 0 .68A16.69 16.69 0 0 0 16 27a16.69 16.69 0 0 0 14.94-10.66a1 1 0 0 0 0-.68M16 22.5a6.5 6.5 0 1 1 6.5-6.5a6.51 6.51 0 0 1-6.5 6.5'/>
            </svg>
          </button>
          <button data-bs-toggle='modal' data-bs-target='#organization_edit' data-org-id='${id}' class='btn btn-sm btn-edit' style="border: 1; border-color: #C68914; color: #c68914" data-title="Update Organization Details">
            <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24">
              <path fill="currentColor" d="m7 17.013l4.413-.015l9.632-9.54c.378-.378.586-.88.586-1.414s-.208-1.036-.586-1.414l-1.586-1.586c-.756-.756-2.075-.752-2.825-.003L7 12.583zM18.045 4.458l1.589 1.583l-1.597 1.582l-1.586-1.585zM9 13.417l6.03-5.973l1.586 1.586l-6.029 5.971L9 15.006z"/>
              <path fill="currentColor" d="M5 21h14c1.103 0 2-.897 2-2v-8.668l-2 2V19H8.158c-.026 0-.053.01-.079.01c-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2"/>
            </svg>
          </button>
          <button data-bs-toggle='modal' data-bs-target='#organization_delete' class='btn btn-sm delete-btn btn-delete text-danger border border-danger' data-title="Delete Organization">
            <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em"" viewBox="0 0 24 24">
              <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m18 9l-.84 8.398c-.127 1.273-.19 1.909-.48 2.39a2.5 2.5 0 0 1-1.075.973C15.098 21 14.46 21 13.18 21h-2.36c-1.279 0-1.918 0-2.425-.24a2.5 2.5 0 0 1-1.076-.973c-.288-.48-.352-1.116-.48-2.389L6 9m7.5 6.5v-5m-3 5v-5m-6-4h4.615m0 0l.386-2.672c.112-.486.516-.828.98-.828h3.038c.464 0 .867.342.98.828l.386 2.672m-5.77 0h5.77m0 0H19.5"/>
            </svg>
          </button>
        </td>`;
      }

      function getOrganizationsData() {
        let html = "";

        $.getJSON("../Cdn/js/data/organization.json", function (response) {
          console.log(response);
          const org = response.data;

          for (let i = 0; i < org.length; i++) {
            let data = org[i];

            html += "<tr>";
            html +=
              "<td class='align-middle text-center'>" +
              data.organization_id +
              "</td>";
            html +=
              "<td class='align-middle text-center' style='max-width: 50px'><img src='" +
              data.logo +
              "' style='width:10em;' /></td>";
            html += "<td class='align-middle'>" + data.name + "</td>";
            html +=
              "<td class='align-middle text-truncate' style='max-width: 150px'>" +
              data.description +
              "</td>";
            html +=
              "<td class='align-middle'>" +
              convertDate(data.created_at) +
              "</td>";
            html += displayActionButtons(data.organization_id);
            html += "</tr>";
          }
          $(".organizations .data-container").html(html);
        });
      }
    </script>
  </head>

  <body>
    <div class="container-fluid">
      <div class="row flex-nowrap" style="height: 100vh">
        <!-- SIDEBAR -->
        <div class="sidebar col-md-3 col-lg-2 px-sm-2 px-0 bg-light"></div>
        <main class="col py-3">
          <!-- HEADER -->
          <div class="header"></div>

          <!-- CONTENT -->
          <div class="content">
            <!-- all content body should be here -->
            <div>
              <div
                class="d-flex flex-row align-items-center justify-content-start mt-2"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="2.5em"
                  height="2.5em"
                  viewBox="0 0 32 32"
                >
                  <path
                    fill="currentColor"
                    d="M11 7a5 5 0 1 1 5.999 4.9V15h5.268A2.733 2.733 0 0 1 25 17.732V20.1a5.002 5.002 0 0 1-1 9.9a5 5 0 0 1-1-9.9v-2.368a.733.733 0 0 0-.733-.733H9.733a.733.733 0 0 0-.733.733V20.1A5.002 5.002 0 0 1 8 30a5 5 0 0 1-1-9.9v-2.368a2.733 2.733 0 0 1 2.733-2.733H15v-3.1A5 5 0 0 1 11 7"
                  />
                </svg>
                <span class="fw-bold fs-2 ms-2">ORGANIZATION</span>
              </div>

              <div
                class="d-flex justify-content-between align-items-center mb-3 mt-2"
              >
                <div
                  class="d-flex justify-content-start align-items-center w-50"
                >
                  <div class="btn-group border border-secondary-subtle">
                    <button
                      type="button"
                      class="btn btn-light dropdown-toggle fw-semibold text-lg-start"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      SORT BY
                    </button>
                    <ul class="dropdown-menu">
                      <li>
                        <a class="dropdown-item" href="#">Organization Name</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Created Date</a>
                      </li>
                    </ul>
                  </div>
                  <input
                    type="email"
                    class="ms-1 form-control"
                    id="exampleFormControlInput1"
                    placeholder="Search by Organization Name"
                  />
                </div>
                <button
                  type="button"
                  data-bs-toggle="modal"
                  data-bs-target="#organization_add"
                  class="btn text-white px-5 btn-add"
                  data-title="Add Organization"
                  style="background-color: #131c39 !important"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="1.5em"
                    height="1.5em"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill="currentColor"
                      d="M11 9h4v2h-4v4H9v-4H5V9h4V5h2zm-1 11a10 10 0 1 1 0-20a10 10 0 0 1 0 20m0-2a8 8 0 1 0 0-16a8 8 0 0 0 0 16"
                    />
                  </svg>
                </button>
              </div>
            </div>
            <div class="list">
              <!-- Table List -->
              <div class="table-responsive">
                <table class="table table-bordered table-striped organizations">
                  <thead>
                    <tr>
                      <th
                        class="align-middle text-center fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        #
                      </th>
                      <th
                        class="align-middle text-center fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        Organization Logo
                      </th>
                      <th
                        class="align-middle fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        Organization Name
                      </th>
                      <th
                        class="align-middle fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        Organization Description
                      </th>
                      <th
                        class="align-middle fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        Created Date
                      </th>
                      <th
                        class="align-middle fw-semibold text-white"
                        style="background-color: #1c1c39"
                      >
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody class="data-container"></tbody>
                </table>
              </div>
            </div>

            <!-- TABLE FOOTER -->
            <div style="display: flex; align-items: center">
              <p style="margin-right: auto">Showing 1 out of 10 pages</p>
              <nav aria-label="...">
                <ul class="pagination">
                  <li class="page-item disabled">
                    <span class="page-link">Previous</span>
                  </li>
                  <li class="page-item"><a class="page-link" href="#">1</a></li>
                  <li class="page-item active">
                    <span class="page-link"> 2 </span>
                  </li>
                  <li class="page-item"><a class="page-link" href="#">3</a></li>
                  <li class="page-item">
                    <a class="page-link" href="#">Next</a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>

          <!-- FOOTER -->
          <div class="footer"></div>

          <!-- ADD MODAL -->
          <div class="modal" id="organization_add" tabindex="-1">
            <div
              class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
              id="form-content"
            >
              <div class="modal-content">
                <div class="form"></div>
              </div>
            </div>
          </div>

          <!-- EDIT MODAL -->
          <div class="modal" id="organization_edit" tabindex="-1">
            <div
              class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
              id="form-content"
            >
              <div class="modal-content">
                <div class="form"></div>
              </div>
            </div>
          </div>

          <!-- DELETE MODAL -->
          <div
            class="modal"
            id="organization_delete"
            tabindex="-1"
          >
            <div
              class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
              id="form-content"
            >
              <div
                class="modal-content"
              >
                <div class="form"></div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
  </body>
</html>
