<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Delete Organization Details</title>
  <link href="../Cdn/vendor/bootstrap-5.3.3/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <link rel="stylesheet" href="../Cdn/css/admin.global.css" />
  <script src="../Cdn/vendor/jquery-3.7.1/jquery-3.7.1.min.js"></script>
  <script src="../Cdn/vendor/popper-2.11.8/popper.min.js"></script>
  <script src="../Cdn/vendor/bootstrap-5.3.3/js/bootstrap.min.js"></script>
  <script src="../Cdn/vendor/validatejs-0.13.1/validate.min.js"></script>
  <script src="../Cdn/js/script.js"></script>

  <script type="text/javascript">
    let id = ""

    $(document).ready(function () {
      $(".header").load("header.html");
      $(".sidebar").load("sidebar.html");
      $(".footer").load("footer.html");

      let params = new URL(document.location.toString()).searchParams;
      id = params.get("id");

      $.getJSON('../Cdn/js/data/organization.json', function (data) {
        let response = data.data;
        f = response.keys(response).find(key => response[key].organization_id == id);

        $(".orgLogo").attr("src", response[f].logo);
        $('#name').text(response[f].name);
        $('#description').text(response[f].description);
      });
    });

    $(document).on("click", "#back", function (e) {
      window.location.href = "organization.list.html"
    });

    // $(document).on("click", ".btn-delete", function (e) {
    //   console.log(id)
    //   $.ajax({
    //     url: '../Cdn/js/data/organization.json',
    //     type: 'DELETE',
    //     data: { "data": [{ organization_id: id }] }, //<-----this should be an object.
    //     contentType: 'application/json',  // <---add this
    //     dataType: 'text',                // <---update this
    //     success: function (result) { console.log("yes", result) },
    //     error: function (result) { console.log("aw", result) }
    //   });

    //   // window.location.href = "organization.list.html"
    // });

    $(document).on("change", "#logo", function (e) {
      var URL = window.URL || window.webkitURL;
      var file = e.target.files[0];
      if (file) {
        $(".orgLogo").attr("src", URL.createObjectURL(file));
      }
    });



    /**
     * Validator Documentation https://validatejs.org/#validators-length
     **/

    // function validateInput(input) {
    //   let message = [];

    //   const data = input.reduce(function (obj, item) {
    //     obj[item.name] = item.value;
    //     return obj;
    //   }, {});

    //   const validator = validate(
    //     {
    //       logo: data.logo,
    //       name: data.name,
    //       description: data.description,
    //     },
    //     {
    //       logo: {
    //         type: "image/png,image/jpeg",
    //       },
    //       name: {
    //         type: "string",
    //         length: { minimum: 4 },
    //       },
    //       description: {
    //         type: "string",
    //         length: { minimum: 10, maximum: 300 },
    //       },
    //     }
    //   );

    //   if (validator !== undefined) {
    //     for (key in validator) {
    //       message.push(validator[key]);
    //     }
    //     return message.join(", ");
    //   }

    //   return false;
    // }
  </script>
</head>

<body>
  <!-- DYNAMIC MODAL -->
  <div class="modal fade" id="dynamicModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered" id="form-content">
      <div class="modal-content">
        <form action="" id="form">
          <input type="hidden" name="csrf_token" id="csrf_token" value="" />
          <div class="modal-body d-flex flex-column justify-content-center align-items-center">
            <i class="bi bi-trash3-fill text-danger" style="font-size: 10em !important;"></i>
            <h1 style="font-weight: bold; font-size: 30px">
              Delete Organization
            </h1>
            <p style="font-size: 15px">
              Are you sure you want to delete this organization?
            </p>
            <div class="text-end">
              <button type="button" class="btn border border-secondary-subtle btn-light" data-bs-dismiss="modal">
                Close
              </button>
              <button type="button" class="btn btn-delete btn-danger">Delete</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row flex-nowrap" style="height: 100vh">
      <!-- SIDEBAR -->
      <div class="sidebar col-md-3 col-lg-2 px-sm-2 px-0 bg-light"></div>
      <main class="col py-3">
        <!-- HEADER -->
        <div class="header"></div>

        <!-- CONTENT -->
        <div class="content">
          <!-- all content body should be here -->

          <div class="card">
            <div class="card-body">
              <div
                class="d-flex justify-content-start mb-2 align-items-center border-bottom border-secondary-subtle pb-1">
                <i class="bi bi-trash3-fill fs-2"></i>
                <h5 class="ms-2 modal-title font-bold">
                  Delete Organization Details
                </h5>
              </div>
              <div class="response"></div>
              <input type="hidden" name="csrf_token" id="csrf_token" value="" />
              <div class="mb-3">
                <label for="logo" class="form-label fw-semibold">Organization Logo</label>
                <img class="orgLogo mb-3 object-fit-contain" width="100%" height="300px" alt="" />
              </div>
              <div class="mb-3">
                <label for="name" class="form-label fw-semibold">Organization Name</label>
                <p id="name"></p>
              </div>
              <div class="mb-3">
                <label for="description" class="form-label fw-semibold">Organization Description</label>
                <p id="description"></p>
              </div>
              <div class="text-end">
                <button id="back" type="button" class="btn border border-secondary" data-bs-dismiss="modal">
                  Back
                </button>
                <button type="button" class="btn btn-danger" data-bs-toggle='modal' data-bs-target='#dynamicModal'>
                  Continue Deletion
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- FOOTER -->
        <div class="footer"></div>
      </main>
    </div>
  </div>
</body>

</html>