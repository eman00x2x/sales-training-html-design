<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add E-Book</title>
    <!-- BOOSTRAP ICONS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- TABLER -->
    <link href="../Cdn/vendor/tabler/dist/css/tabler.min.css" rel="stylesheet" />
    <link href="../Cdn/vendor/tabler/dist/css/tabler-vendors.min.css?1695847769" rel="stylesheet" />
    <link rel="stylesheet" href="../Cdn/css/admin.global.css" />
    <script src="../Cdn/vendor/jquery-3.7.1/jquery-3.7.1.min.js"></script>
    <script src="../Cdn/js/script.js"></script>
    <script src="../Cdn/vendor/tabler/dist/js/tabler.min.js" defer></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".header").load("header.html");
            $(".sidebar").load("sidebar.html");
            $(".footer").load("footer.html");
        });

        $(document).on("click", ".btn-back", function () {
            window.location.href = "ebooks.list.html";
        });

        $(document).on("change", "#thumbnail", function (e) {
            let URL = window.URL || window.webkitURL;
            let file = e.target.files[0];

            let imageTag =
                "<h6>Uploaded Files</h6><div class='d-flex flex-row justify-content-start align-items-center rounded shadow-sm p-2 bg-white rounded border border-secondary-subtle'><img src='" +
                URL.createObjectURL(file) +
                "'class='border border-secondary-subtle p-2 rounded' name='org_logo' style='height: 100px'/><div class='d-flex flex-column'><span class='ms-4 fw-semibold'>" +
                e.target.files[0].name +
                "</span> <span class='ms-4 fw-normal'>" +
                formatFileSize(e.target.files[0].size) +
                "</span><div></div>";

            if (file) {
                $(".thumbnail_image").html(imageTag);
            }
        });

        function validateInput(input) {

            let message = [];

            let data = input.reduce(function (obj, item) {
                obj[item.name] = item.value;
                return obj;
            }, {});

            let validator = validate({
                thumbnail: data.thumbnail,
                title: data.title,
                subtitle: data.subtitle,
                author: data.author,
                category: data.category,
                description: data.description,
                group: data.group,
                code: data.code,
            }, {
                logo: {
                    type: "image/png,image/jpeg",
                },
                title: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 20 }
                },
                subtitle: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 50 }
                },
                author: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 50 }
                },
                category: {
                    presence: { allowEmpty: false },
                },
                description: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 100 }
                },
                group: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 10 }
                },
                code: {
                    presence: { allowEmpty: false },
                    type: "string",
                    length: { maximum: 12 }
                }
            });

            if (validator !== undefined) {
                for (key in validator) {
                    message.push(validator[key]);
                }
                return message.join(", ");
            }
            return false;
        }
    </script>
</head>

<body>
    <div class="page">
        <!-- SIDEBAR -->
        <aside class="sidebar navbar navbar-vertical navbar-expand-lg navbar-transparent"
            style="background-color: #1c1c39 !important;" data-bs-theme="dark"></aside>

        <div class="page-wrapper">
            <!-- HEADER -->
            <div class="header"></div>

            <!-- CONTENT -->
            <div class="page-body content">
                <div class="container-fluid">
                    <!-- FORM -->
                    <div class="content">
                        <div class="card">
                            <div class="card-body">
                                <form id="form" method="post" action="">
                                    <input type="hidden" name="csrf_token" id="csrf_token" value="" />
                                    <div class="d-flex align-items-center">
                                        <div class="d-flex flex-row justify-content-center align-items-center">
                                            <i class="bi bi-journal-plus fs-2"></i>
                                            <h5 class="ms-2 fs-2 fw-bold my-auto">
                                                Add E-book
                                            </h5>
                                        </div>
                                    </div>
                                    <hr class="m-0">
                                    <div class="response"></div>
                                    <div class="mb-3">
                                        <label for="thumbnail" class="form-label fw-semibold mt-3">Thumbnail
                                            Image</label>
                                        <fieldset class="upload_dropzone text-center p-4">
                                            <legend class="visually-hidden">Image uploader</legend>
                                            <i class="bi bi-cloud-arrow-up-fill h1" style="font-size: 5vw;"></i>
                                            <p class="small my-1">
                                                Drag &amp; Drop background image(s) inside dashed region<br /><i>or</i>
                                            </p>
                                            <input id="thumbnail" name="thumbnail" class="position-absolute invisible"
                                                type="file" accept="image/jpeg, image/png, image/svg+xml" />
                                            <label class="btn btn-upload mb-3 bg-primary text-white"
                                                for="thumbnail">Choose
                                                file(s)</label>
                                            <div
                                                class="upload_gallery d-flex flex-wrap justify-content-center gap-3 mb-0">
                                            </div>
                                        </fieldset>
                                        <div class="mt-3 thumbnail_image"></div>
                                    </div>
                                    <input type="file" id="fileInput" style="display: none;">
                                    <div class="d-flex flex-column form-group">
                                        <div class="row align-items-end">
                                            <div class="col-6">
                                                <label for="title" class="form-label fw-semibold">Title</label>
                                                <input type="text" name="title" id="title" class="form-control" value=""
                                                    autocomplete="off">
                                            </div>
                                            <div class="col-6">
                                                <label for="subtitle" class="form-label fw-semibold">Subtitle</label>
                                                <input type="text" name="subtitle" id="subtitle" class="form-control"
                                                    value="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex flex-column form-group">
                                        <div class="row align-items-end mt-4">
                                            <div class="col-6">
                                                <label for="author" class="form-label fw-semibold">Author</label>
                                                <input type="text" name="author" id="author" class="form-control"
                                                    value="" autocomplete="off">
                                            </div>
                                            <div class="col-6">
                                                <label for="category" class="form-label fw-semibold">Category</label>
                                                <select id="category" class="form-select" name="category">
                                                    <option value="" selected disabled>Select category</option>
                                                    <option value="sales">Sales</option>
                                                    <option value="real-estate">Real-Estate</option>
                                                    <option value="properties">Properties</option>
                                                    <option value="necessities">Necessities</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex flex-column form-group mt-4">
                                        <label for="description" class="form-label fw-semibold">Description</label>
                                        <textarea name="description" id="description" class="form-control" value=""
                                            autocomplete="off" wrap=physical rows="5"></textarea>
                                    </div>
                                    <div class="d-flex flex-column form-group">
                                        <div class="row align-items-end mt-4">
                                            <div class="col-6">
                                                <label for="group" class="form-label fw-semibold">E-Book Group</label>
                                                <input type="text" name="group" id="group" class="form-control" value=""
                                                    autocomplete="off">
                                            </div>
                                            <div class="col-6">
                                                <label for="code" class="form-label fw-semibold">Code</label>
                                                <input type="text" name="code" id="code" class="form-control" value=""
                                                    autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2 justify-content-end mt-3">
                                        <button class="btn btn-light btn-back border border-secondary" type="button">
                                            Back
                                        </button>
                                        <button class="btn-save btn btn-success btn-md">
                                            Submit
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="footer container-fluid"></div>
        </div>
    </div>
</body>

</html>