<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Organizations</title>
  <link href="../Cdn/vendor/bootstrap-5.3.3/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../Cdn/css/admin.global.css" />
  <script src="../Cdn/vendor/jquery-3.7.1/jquery-3.7.1.min.js"></script>
  <script src="../Cdn/vendor/popper-2.11.8/popper.min.js"></script>
  <script src="../Cdn/vendor/bootstrap-5.3.3/js/bootstrap.min.js"></script>
  <script src="../Cdn/js/script.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      $(".header").load("header.html");
      $(".sidebar").load("sidebar.html");
      $(".footer").load("footer.html");
      getOrganizationsData();
    });

    $(document).on('click', '.btn-add', function (e) {
      window.location.href = "organization.create.html";
    });

    $(document).on('click', '.btn-edit', function (e) {
      id = $(this).data('id');
      window.location.href = "organization.update.html?id=" + id;
    });

    $(document).on('click', '.btn-delete', function (e) {
      id = $(this).data('id');
      window.location.href = "organization.delete.html?id=" + id;
    });

    function displayActionButtons(id) {
      return `<td class='align-middle'>
          <span class='btn btn-sm btn-view border border-primary btn-view text-primary' data-title="View Organization">
            <i class="bi bi-eye h4"></i>
          </span>
          <span data-id='${id}' class='btn btn-sm btn-edit' style="border: 1; border-color: #C68914; color: #c68914" data-title="Update Organization Details">
            <i class="bi bi-pencil-square h4"></i>
          </span>
          <span data-id='${id}' class='btn btn-sm text-danger border border-danger btn-delete ' data-title="Delete Organization">
            <i class="bi bi-trash h4"></i>
          </span>
        </td>`;
    }

    function getOrganizationsData() {
      let html = "";

      $.getJSON("../Cdn/js/data/organization.json", function (response) {
        const org = response.data;

        for (let i = 0; i < org.length; i++) {
          let data = org[i];

          html += "<tr>";
          html +=
            "<td class='align-middle text-center'>" +
            data.organization_id +
            "</td>";
          html +=
            "<td class='align-middle text-center' style='max-width: 50px'><img src='" +
            data.logo +
            "' style='width:10em;' /></td>";
          html += "<td class='align-middle'>" + data.name + "</td>";
          html +=
            "<td class='align-middle text-truncate' style='max-width: 150px'>" +
            data.description +
            "</td>";
          html +=
            "<td class='align-middle'>" +
            convertDate(data.created_at) +
            "</td>";
          html += displayActionButtons(data.organization_id);
          html += "</tr>";
        }
        $(".organizations .data-container").html(html);
      });
    }
  </script>
</head>

<body>
  <!-- DYNAMIC MODAL -->
  <div class="modal fade" id="dynamicModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered" id="form-content">
      <div class="modal-content">
        <div class="response-data-container"></div>
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row flex-nowrap" style="height: 100vh">
      <!-- SIDEBAR -->
      <div class="sidebar col-md-3 col-lg-2 px-sm-2 px-0 bg-light"></div>
      <main class="col py-3">
        <!-- HEADER -->
        <div class="header"></div>

        <!-- CONTENT -->
        <div class="content">
          <div>

            <!-- TITLE -->
            <div class="d-flex flex-row align-items-center justify-content-start mt-2">
              <i class="bi bi-diagram-2-fill fs-2"></i>
              <span class="fw-bold fs-2 ms-2">ORGANIZATION</span>
            </div>

            <!-- SORT, FILTER AND SEARCH -->
            <div class="d-flex justify-content-between align-items-center mb-3 mt-2">
              <div class="d-flex justify-content-start align-items-center w-50">
                <div class="btn-group border border-secondary-subtle">
                  <button type="button" class="btn btn-light dropdown-toggle fw-semibold text-lg-start"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    SORT BY
                  </button>
                  <ul class="dropdown-menu">
                    <li>
                      <a class="dropdown-item" href="#">Organization Name</a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">Created Date</a>
                    </li>
                  </ul>
                </div>
                <input type="text" class="search ms-1 form-control" id="search"
                  placeholder="Search by Organization Name" name="search" value="" />
              </div>
              <button type="button" class="btn text-white px-5 btn-add" data-title="Add Organization"
                style="background-color: #131c39 !important">
                <i class="bi bi-plus-circle fs-5"></i>
              </button>
            </div>
          </div>

          <!-- TABLE LIST -->
          <div class="list">
            <div class="table-responsive">
              <table class="table table-bordered table-striped organizations">
                <thead>
                  <tr>
                    <th class="align-middle text-center fw-semibold text-white" style="background-color: #1c1c39">
                      #
                    </th>
                    <th class="align-middle text-center fw-semibold text-white" style="background-color: #1c1c39">
                      Organization Logo
                    </th>
                    <th class="align-middle fw-semibold text-white" style="background-color: #1c1c39">
                      Organization Name
                    </th>
                    <th class="align-middle fw-semibold text-white" style="background-color: #1c1c39">
                      Organization Description
                    </th>
                    <th class="align-middle fw-semibold text-white" style="background-color: #1c1c39">
                      Created Date
                    </th>
                    <th class="align-middle fw-semibold text-white" style="background-color: #1c1c39">
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody class="data-container"></tbody>
              </table>
            </div>
          </div>

          <!-- TABLE FOOTER -->
          <div style="display: flex; align-items: center">
            <p style="margin-right: auto">Showing 1 out of 10 pages</p>
            <nav aria-label="...">
              <ul class="pagination">
                <li class="page-item disabled">
                  <span class="page-link">Previous</span>
                </li>
                <li class="page-item"><a class="page-link" href="#">1</a></li>
                <li class="page-item active">
                  <span class="page-link"> 2 </span>
                </li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                  <a class="page-link" href="#">Next</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>

        <!-- FOOTER -->
        <div class="footer"></div>
      </main>
    </div>
  </div>
</body>

</html>